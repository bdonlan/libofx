<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>LibOFX: ofx_utilities.cpp File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>ofx_utilities.cpp File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Various simple functions for type conversion &amp; al. 
<p>

<p>Definition in file <a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp-source.html">fx-0.9.0/lib/ofx_utilities.cpp</a>.</p>

<p>

<p>
<a href="fx-0_89_80_2lib_2ofx__utilities_8cpp-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2c89f3449c0cc91f289ecbef54188d8d"></a><!-- doxytag: member="fx-0.9.0/lib/ofx_utilities.cpp::DIRSEP" ref="2c89f3449c0cc91f289ecbef54188d8d" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp.html#2c89f3449c0cc91f289ecbef54188d8d">DIRSEP</a>&nbsp;&nbsp;&nbsp;&quot;/&quot;</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp.html#e7575392f9f9c464ede10057dec0e8e4">CharStringtostring</a> (const SGMLApplication::CharString source, string &amp;dest)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert OpenSP CharString to a C++ STL string.  <a href="#e7575392f9f9c464ede10057dec0e8e4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="50b88c84b759d3058397336e7ea42c32"></a><!-- doxytag: member="fx-0.9.0/lib/ofx_utilities.cpp::AppendCharStringtostring" ref="50b88c84b759d3058397336e7ea42c32" args="(const SGMLApplication::CharString source, string &amp;dest)" -->
string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp.html#50b88c84b759d3058397336e7ea42c32">AppendCharStringtostring</a> (const SGMLApplication::CharString source, string &amp;dest)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append an OpenSP CharString to an existing C++ STL string. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">time_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp.html#5fdbbc08f8d80a534f8db03d25316d7a">ofxdate_to_time_t</a> (const string ofxdate)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert a C++ string containing a time in OFX format to a C time_t.  <a href="#5fdbbc08f8d80a534f8db03d25316d7a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp.html#bfca5b423e5d7b194eb53c53f706f6ba">ofxamount_to_double</a> (const string ofxamount)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert OFX amount of money to double float.  <a href="#bfca5b423e5d7b194eb53c53f706f6ba"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp.html#34933785dd934134973847e58a700733">strip_whitespace</a> (const string para_string)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sanitize a string coming from OpenSP.  <a href="#34933785dd934134973847e58a700733"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a0e945c824a3012017b4babd721d9f38"></a><!-- doxytag: member="fx-0.9.0/lib/ofx_utilities.cpp::mkTempFileName" ref="a0e945c824a3012017b4babd721d9f38" args="(const char *tmpl, char *buffer, unsigned int size)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp.html#a0e945c824a3012017b4babd721d9f38">mkTempFileName</a> (const char *tmpl, char *buffer, unsigned int size)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="e7575392f9f9c464ede10057dec0e8e4"></a><!-- doxytag: member="fx-0.9.0/lib/ofx_utilities.cpp::CharStringtostring" ref="e7575392f9f9c464ede10057dec0e8e4" args="(const SGMLApplication::CharString source, string &amp;dest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string CharStringtostring           </td>
          <td>(</td>
          <td class="paramtype">const SGMLApplication::CharString&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string &amp;&nbsp;</td>
          <td class="paramname"> <em>dest</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Convert OpenSP CharString to a C++ STL string. 
<p>
Convert an OpenSP CharString directly to a C++ stream, to enable the use of cout directly for debugging. 
<p>Definition at line <a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp-source.html#l00069">69</a> of file <a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp-source.html">fx-0.9.0/lib/ofx_utilities.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="bfca5b423e5d7b194eb53c53f706f6ba"></a><!-- doxytag: member="fx-0.9.0/lib/ofx_utilities.cpp::ofxamount_to_double" ref="bfca5b423e5d7b194eb53c53f706f6ba" args="(const string ofxamount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ofxamount_to_double           </td>
          <td>(</td>
          <td class="paramtype">const string&nbsp;</td>
          <td class="paramname"> <em>ofxamount</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Convert OFX amount of money to double float. 
<p>
Convert a C++ string containing an amount of money as specified by the OFX standard and convert it to a double float. <dl class="note" compact><dt><b>Note:</b></dt><dd>The ofx number format is the following: "." or "," as decimal separator, NO thousands separator. </dd></dl>

<p>Definition at line <a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp-source.html#l00174">174</a> of file <a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp-source.html">fx-0.9.0/lib/ofx_utilities.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="5fdbbc08f8d80a534f8db03d25316d7a"></a><!-- doxytag: member="fx-0.9.0/lib/ofx_utilities.cpp::ofxdate_to_time_t" ref="5fdbbc08f8d80a534f8db03d25316d7a" args="(const string ofxdate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t ofxdate_to_time_t           </td>
          <td>(</td>
          <td class="paramtype">const string&nbsp;</td>
          <td class="paramname"> <em>ofxdate</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Convert a C++ string containing a time in OFX format to a C time_t. 
<p>
Converts a date from the YYYYMMDDHHMMSS.XXX[gmt offset:tz name] OFX format (see OFX 2.01 spec p.66) to a C time_t. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ofxdate</em>&nbsp;</td><td>date from the YYYYMMDDHHMMSS.XXX[gmt offset:tz name] OFX format </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>C time_t in the local time zone </dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd><ul>
<li>The library always returns the time in the systems local time </li>
<li>OFX defines the date up to the millisecond. The library ignores those milliseconds, since ANSI C does not handle such precision cleanly. The date provided by LibOFX is precise to the second, assuming that information this precise was provided in the ofx file. So you wont know the millisecond you were ruined...</li>
</ul>
<p>
DEVIATION FROM THE SPECS : The OFX specifications (both version 1.6 and 2.02) state that a client should assume that if the server returns a date without à specific time, we assume it means 0h00 GMT. As such, when we apply the local timezone and for example you are in the EST timezone, we will remove 5h, and the transaction will have occurred on the prior day! This is probably not what the bank intended (and will lead to systematic errors), but the spec is quite explicit in this respect (Ref: OFX 2.01 spec pp. 66-68)<br>
<br>
 To solve this problem (since usually a time error is relatively unimportant, but date error is), and to avoid problems in Australia caused by the behaviour in libofx up to 0.6.4, it was decided starting with 0.6.5 to use the following behavior:<br>
<br>
 -No specific time is given in the file (date only): Considering that most banks seem to be sending dates in this format represented as local time (not compliant with the specs), the transaction is assumed to have occurred 11h59 (just before noon) LOCAL TIME. This way, we should never change the date, since you'd have to travel in a timezone at least 11 hours backwards or 13 hours forward from your own to introduce mistakes. However, if you are in timezone +13 or +14, and your bank meant the data to be interpreted by the spec, you will get the wrong date. We hope that banks in those timezone will either represent in local time like most, or specify the timezone properly.<br>
<br>
 -No timezone is specified, but exact time is, the same behavior is mostly used, as many banks just append zeros instead of using the short notation. However, the time specified is used, even if 0 (midnight).<br>
<br>
 -When a timezone is specified, it is always used to properly convert in local time, following the spec. </dd></dl>

<p>Definition at line <a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp-source.html#l00106">106</a> of file <a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp-source.html">fx-0.9.0/lib/ofx_utilities.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="34933785dd934134973847e58a700733"></a><!-- doxytag: member="fx-0.9.0/lib/ofx_utilities.cpp::strip_whitespace" ref="34933785dd934134973847e58a700733" args="(const string para_string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string strip_whitespace           </td>
          <td>(</td>
          <td class="paramtype">const string&nbsp;</td>
          <td class="paramname"> <em>para_string</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sanitize a string coming from OpenSP. 
<p>
Many weird caracters can be present inside a SGML element, as a result on the transfer protocol, or for any reason. This function greatly enhances the reliability of the library by zapping those gremlins (backspace,formfeed,newline,carriage return, horizontal and vertical tabs) as well as removing whitespace at the begining and end of the string. Otherwise, many problems will occur during stringmatching. 
<p>Definition at line <a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp-source.html#l00195">195</a> of file <a class="el" href="fx-0_89_80_2lib_2ofx__utilities_8cpp-source.html">fx-0.9.0/lib/ofx_utilities.cpp</a>.</p>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Nov 19 20:28:00 2007 for LibOFX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
